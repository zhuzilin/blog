{"expireTime":9007200818315813000,"key":"transformer-remark-markdown-ast-3d01004ac353df52750c07f5dfb93176-gatsby-remark-katexgatsby-remark-prismjs-","val":{"type":"root","children":[{"type":"heading","depth":2,"children":[{"type":"text","value":"Part One: System call tracing","position":{"start":{"line":2,"column":4,"offset":4},"end":{"line":2,"column":33,"offset":33},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":33,"offset":33},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"第一个任务是让每次调用system call的时候，都会输出其名字和返回值。需要修改的代码是","position":{"start":{"line":4,"column":1,"offset":35},"end":{"line":4,"column":47,"offset":81},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">syscall.c</code>","position":{"start":{"line":4,"column":47,"offset":81},"end":{"line":4,"column":58,"offset":92},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":35},"end":{"line":4,"column":58,"offset":92},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"我就直接用了暴力方法，如下：","position":{"start":{"line":6,"column":1,"offset":94},"end":{"line":6,"column":15,"offset":108},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":94},"end":{"line":6,"column":15,"offset":108},"indent":[]}},{"type":"html","lang":"c","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token keyword\">static</span> <span class=\"token keyword\">char</span><span class=\"token operator\">*</span> syscalls_name<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n<span class=\"token punctuation\">[</span>SYS_fork<span class=\"token punctuation\">]</span>    <span class=\"token string\">\"fork\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">[</span>SYS_exit<span class=\"token punctuation\">]</span>    <span class=\"token string\">\"exit\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">[</span>SYS_wait<span class=\"token punctuation\">]</span>    <span class=\"token string\">\"wait\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">[</span>SYS_pipe<span class=\"token punctuation\">]</span>    <span class=\"token string\">\"pipe\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">[</span>SYS_read<span class=\"token punctuation\">]</span>    <span class=\"token string\">\"read\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">[</span>SYS_kill<span class=\"token punctuation\">]</span>    <span class=\"token string\">\"kill\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">[</span>SYS_exec<span class=\"token punctuation\">]</span>    <span class=\"token string\">\"exec\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">[</span>SYS_fstat<span class=\"token punctuation\">]</span>   <span class=\"token string\">\"fstat\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">[</span>SYS_chdir<span class=\"token punctuation\">]</span>   <span class=\"token string\">\"chdir\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">[</span>SYS_dup<span class=\"token punctuation\">]</span>     <span class=\"token string\">\"dup\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">[</span>SYS_getpid<span class=\"token punctuation\">]</span>  <span class=\"token string\">\"getpid\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">[</span>SYS_sbrk<span class=\"token punctuation\">]</span>    <span class=\"token string\">\"sbrk\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">[</span>SYS_sleep<span class=\"token punctuation\">]</span>   <span class=\"token string\">\"sleep\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">[</span>SYS_uptime<span class=\"token punctuation\">]</span>  <span class=\"token string\">\"uptime\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">[</span>SYS_open<span class=\"token punctuation\">]</span>    <span class=\"token string\">\"open\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">[</span>SYS_write<span class=\"token punctuation\">]</span>   <span class=\"token string\">\"write\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">[</span>SYS_mknod<span class=\"token punctuation\">]</span>   <span class=\"token string\">\"mknod\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">[</span>SYS_unlink<span class=\"token punctuation\">]</span>  <span class=\"token string\">\"unlink\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">[</span>SYS_link<span class=\"token punctuation\">]</span>    <span class=\"token string\">\"link\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">[</span>SYS_mkdir<span class=\"token punctuation\">]</span>   <span class=\"token string\">\"mkdir\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">[</span>SYS_close<span class=\"token punctuation\">]</span>   <span class=\"token string\">\"close\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">void</span>\n<span class=\"token function\">syscall</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">int</span> num<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">struct</span> <span class=\"token class-name\">proc</span> <span class=\"token operator\">*</span>curproc <span class=\"token operator\">=</span> <span class=\"token function\">myproc</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  num <span class=\"token operator\">=</span> curproc<span class=\"token operator\">-></span>tf<span class=\"token operator\">-></span>eax<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>num <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> num <span class=\"token operator\">&lt;</span> <span class=\"token function\">NELEM</span><span class=\"token punctuation\">(</span>syscalls<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> syscalls<span class=\"token punctuation\">[</span>num<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    curproc<span class=\"token operator\">-></span>tf<span class=\"token operator\">-></span>eax <span class=\"token operator\">=</span> syscalls<span class=\"token punctuation\">[</span>num<span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">cprintf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s -> %d\\n\"</span><span class=\"token punctuation\">,</span> syscalls_name<span class=\"token punctuation\">[</span>num<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> curproc<span class=\"token operator\">-></span>tf<span class=\"token operator\">-></span>eax<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">cprintf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%d %s: unknown sys call %d\\n\"</span><span class=\"token punctuation\">,</span>\n            curproc<span class=\"token operator\">-></span>pid<span class=\"token punctuation\">,</span> curproc<span class=\"token operator\">-></span>name<span class=\"token punctuation\">,</span> num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    curproc<span class=\"token operator\">-></span>tf<span class=\"token operator\">-></span>eax <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":8,"column":1,"offset":110},"end":{"line":49,"column":4,"offset":1021},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"至于如何输出system call arguments，应该是要用","position":{"start":{"line":51,"column":1,"offset":1023},"end":{"line":51,"column":34,"offset":1056},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">curproc-&gt;tf</code>","position":{"start":{"line":51,"column":34,"offset":1056},"end":{"line":51,"column":47,"offset":1069},"indent":[]}},{"type":"text","value":"里面的值吧，具体具体没想好。","position":{"start":{"line":51,"column":47,"offset":1069},"end":{"line":51,"column":61,"offset":1083},"indent":[]}}],"position":{"start":{"line":51,"column":1,"offset":1023},"end":{"line":51,"column":61,"offset":1083},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"这样之后，直接运行kernel的结果是：","position":{"start":{"line":53,"column":1,"offset":1085},"end":{"line":53,"column":21,"offset":1105},"indent":[]}}],"position":{"start":{"line":53,"column":1,"offset":1085},"end":{"line":53,"column":21,"offset":1105},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token punctuation\">..</span>.\nfork -<span class=\"token operator\">></span> 2\n<span class=\"token function\">exec</span> -<span class=\"token operator\">></span> 0\n<span class=\"token function\">open</span> -<span class=\"token operator\">></span> 3\nclose -<span class=\"token operator\">></span> 0\n<span class=\"token variable\">$write</span> -<span class=\"token operator\">></span> 1\n <span class=\"token function\">write</span> -<span class=\"token operator\">></span> 1</code></pre></div>","position":{"start":{"line":55,"column":1,"offset":1107},"end":{"line":63,"column":4,"offset":1187},"indent":[1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Part Two: Date system call","position":{"start":{"line":65,"column":4,"offset":1192},"end":{"line":65,"column":30,"offset":1218},"indent":[]}}],"position":{"start":{"line":65,"column":1,"offset":1189},"end":{"line":65,"column":30,"offset":1218},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"注意在做这一问的时候，最好把part 1的print给注释掉，不然太乱了。","position":{"start":{"line":67,"column":1,"offset":1220},"end":{"line":67,"column":38,"offset":1257},"indent":[]}}],"position":{"start":{"line":67,"column":1,"offset":1220},"end":{"line":67,"column":38,"offset":1257},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"如题目所说，仿照","position":{"start":{"line":69,"column":1,"offset":1259},"end":{"line":69,"column":9,"offset":1267},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">uptime</code>","position":{"start":{"line":69,"column":9,"offset":1267},"end":{"line":69,"column":17,"offset":1275},"indent":[]}},{"type":"text","value":"，有：","position":{"start":{"line":69,"column":17,"offset":1275},"end":{"line":69,"column":20,"offset":1278},"indent":[]}}],"position":{"start":{"line":69,"column":1,"offset":1259},"end":{"line":69,"column":20,"offset":1278},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">grep</span> -n <span class=\"token function\">uptime</span> *.<span class=\"token punctuation\">[</span>chS<span class=\"token punctuation\">]</span>\nsyscall.c:105:extern int sys_uptime<span class=\"token punctuation\">(</span>void<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nsyscall.c:122:<span class=\"token punctuation\">[</span>SYS_uptime<span class=\"token punctuation\">]</span>  sys_uptime,\nsyscall.c:147:<span class=\"token punctuation\">[</span>SYS_uptime<span class=\"token punctuation\">]</span>  <span class=\"token string\">\"uptime\"</span>,\nsyscall.h:15:<span class=\"token comment\">#define SYS_uptime 14</span>\nsysproc.c:83:sys_uptime<span class=\"token punctuation\">(</span>void<span class=\"token punctuation\">)</span>\nuser.h:25:int uptime<span class=\"token punctuation\">(</span>void<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nusys.S:31:SYSCALL<span class=\"token punctuation\">(</span>uptime<span class=\"token punctuation\">)</span></code></pre></div>","position":{"start":{"line":71,"column":1,"offset":1280},"end":{"line":80,"column":4,"offset":1556},"indent":[1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"所以在","position":{"start":{"line":82,"column":1,"offset":1558},"end":{"line":82,"column":4,"offset":1561},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">syscall.h</code>","position":{"start":{"line":82,"column":4,"offset":1561},"end":{"line":82,"column":15,"offset":1572},"indent":[]}},{"type":"text","value":"中加入","position":{"start":{"line":82,"column":15,"offset":1572},"end":{"line":82,"column":18,"offset":1575},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">SYS_date</code>","position":{"start":{"line":82,"column":18,"offset":1575},"end":{"line":82,"column":28,"offset":1585},"indent":[]}},{"type":"text","value":"，","position":{"start":{"line":82,"column":28,"offset":1585},"end":{"line":82,"column":29,"offset":1586},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">extern int sys_date(struct rtcdate*);</code>","position":{"start":{"line":82,"column":29,"offset":1586},"end":{"line":82,"column":68,"offset":1625},"indent":[]}},{"type":"text","value":"。之后，在","position":{"start":{"line":82,"column":68,"offset":1625},"end":{"line":82,"column":73,"offset":1630},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">sysproc.c</code>","position":{"start":{"line":82,"column":73,"offset":1630},"end":{"line":82,"column":84,"offset":1641},"indent":[]}},{"type":"text","value":"中加入：","position":{"start":{"line":82,"column":84,"offset":1641},"end":{"line":82,"column":88,"offset":1645},"indent":[]}}],"position":{"start":{"line":82,"column":1,"offset":1558},"end":{"line":82,"column":88,"offset":1645},"indent":[]}},{"type":"html","lang":"c","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token keyword\">int</span> <span class=\"token function\">sys_date</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">struct</span> <span class=\"token class-name\">rtcdate</span> <span class=\"token operator\">*</span>r<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">argptr</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>p<span class=\"token punctuation\">,</span> <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">struct</span> <span class=\"token class-name\">rtcdate</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">cmostime</span><span class=\"token punctuation\">(</span>r<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":84,"column":1,"offset":1647},"end":{"line":92,"column":4,"offset":1784},"indent":[1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"在","position":{"start":{"line":94,"column":1,"offset":1786},"end":{"line":94,"column":2,"offset":1787},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">user.h</code>","position":{"start":{"line":94,"column":2,"offset":1787},"end":{"line":94,"column":10,"offset":1795},"indent":[]}},{"type":"text","value":"中加入","position":{"start":{"line":94,"column":10,"offset":1795},"end":{"line":94,"column":13,"offset":1798},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">int sys_date(struct rtcdate*);</code>","position":{"start":{"line":94,"column":13,"offset":1798},"end":{"line":94,"column":45,"offset":1830},"indent":[]}},{"type":"text","value":"。在","position":{"start":{"line":94,"column":45,"offset":1830},"end":{"line":94,"column":47,"offset":1832},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">usys.S</code>","position":{"start":{"line":94,"column":47,"offset":1832},"end":{"line":94,"column":55,"offset":1840},"indent":[]}},{"type":"text","value":"中加入","position":{"start":{"line":94,"column":55,"offset":1840},"end":{"line":94,"column":58,"offset":1843},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">SYSCALL(date)</code>","position":{"start":{"line":94,"column":58,"offset":1843},"end":{"line":94,"column":73,"offset":1858},"indent":[]}},{"type":"text","value":"。","position":{"start":{"line":94,"column":73,"offset":1858},"end":{"line":94,"column":74,"offset":1859},"indent":[]}}],"position":{"start":{"line":94,"column":1,"offset":1786},"end":{"line":94,"column":74,"offset":1859},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"之后按照要求加入加入","position":{"start":{"line":96,"column":1,"offset":1861},"end":{"line":96,"column":11,"offset":1871},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">date.c</code>","position":{"start":{"line":96,"column":11,"offset":1871},"end":{"line":96,"column":19,"offset":1879},"indent":[]}},{"type":"text","value":"文件，进行修改：","position":{"start":{"line":96,"column":19,"offset":1879},"end":{"line":96,"column":27,"offset":1887},"indent":[]}}],"position":{"start":{"line":96,"column":1,"offset":1861},"end":{"line":96,"column":27,"offset":1887},"indent":[]}},{"type":"html","lang":"c","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token keyword\">int</span>\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">struct</span> <span class=\"token class-name\">rtcdate</span> r<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">date</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>r<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"date failed\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// your code to print the time in any format you like...</span>\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"UTC %d-%d-%d %d:%d:%d\\n\"</span><span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">.</span>year<span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">.</span>month<span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">.</span>day<span class=\"token punctuation\">,</span> \\\n                                       r<span class=\"token punctuation\">.</span>hour<span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">.</span>minute<span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">.</span>second<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","position":{"start":{"line":98,"column":1,"offset":1889},"end":{"line":114,"column":4,"offset":2226},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"最后，在","position":{"start":{"line":116,"column":1,"offset":2228},"end":{"line":116,"column":5,"offset":2232},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">Makefile</code>","position":{"start":{"line":116,"column":5,"offset":2232},"end":{"line":116,"column":15,"offset":2242},"indent":[]}},{"type":"text","value":"的","position":{"start":{"line":116,"column":15,"offset":2242},"end":{"line":116,"column":16,"offset":2243},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">UPPROGS</code>","position":{"start":{"line":116,"column":16,"offset":2243},"end":{"line":116,"column":25,"offset":2252},"indent":[]}},{"type":"text","value":"中加入","position":{"start":{"line":116,"column":25,"offset":2252},"end":{"line":116,"column":28,"offset":2255},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">_date</code>","position":{"start":{"line":116,"column":28,"offset":2255},"end":{"line":116,"column":35,"offset":2262},"indent":[]}},{"type":"text","value":"。就大功告成了。","position":{"start":{"line":116,"column":35,"offset":2262},"end":{"line":116,"column":43,"offset":2270},"indent":[]}}],"position":{"start":{"line":116,"column":1,"offset":2228},"end":{"line":116,"column":43,"offset":2270},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">date</span>\nUTC 2019-2-19 19:6:33</code></pre></div>","position":{"start":{"line":118,"column":1,"offset":2272},"end":{"line":121,"column":4,"offset":2312},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"注意，xv6的","position":{"start":{"line":123,"column":1,"offset":2314},"end":{"line":123,"column":8,"offset":2321},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">printf</code>","position":{"start":{"line":123,"column":8,"offset":2321},"end":{"line":123,"column":16,"offset":2329},"indent":[]}},{"type":"text","value":"没有实现","position":{"start":{"line":123,"column":16,"offset":2329},"end":{"line":123,"column":20,"offset":2333},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">%02d</code>","position":{"start":{"line":123,"column":20,"offset":2333},"end":{"line":123,"column":26,"offset":2339},"indent":[]}},{"type":"text","value":"这样的操作，所以也没办法了。","position":{"start":{"line":123,"column":26,"offset":2339},"end":{"line":123,"column":40,"offset":2353},"indent":[]}}],"position":{"start":{"line":123,"column":1,"offset":2314},"end":{"line":123,"column":40,"offset":2353},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"这个作业的目的就是为了总结一下，大致应该是在","position":{"start":{"line":125,"column":1,"offset":2355},"end":{"line":125,"column":23,"offset":2377},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">sh</code>","position":{"start":{"line":125,"column":23,"offset":2377},"end":{"line":125,"column":27,"offset":2381},"indent":[]}},{"type":"text","value":"中调用","position":{"start":{"line":125,"column":27,"offset":2381},"end":{"line":125,"column":30,"offset":2384},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">date</code>","position":{"start":{"line":125,"column":30,"offset":2384},"end":{"line":125,"column":36,"offset":2390},"indent":[]}},{"type":"text","value":"会调用","position":{"start":{"line":125,"column":36,"offset":2390},"end":{"line":125,"column":39,"offset":2393},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">date.c</code>","position":{"start":{"line":125,"column":39,"offset":2393},"end":{"line":125,"column":47,"offset":2401},"indent":[]}},{"type":"text","value":"，而","position":{"start":{"line":125,"column":47,"offset":2401},"end":{"line":125,"column":49,"offset":2403},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">date.c</code>","position":{"start":{"line":125,"column":49,"offset":2403},"end":{"line":125,"column":57,"offset":2411},"indent":[]}},{"type":"text","value":"中调用的","position":{"start":{"line":125,"column":57,"offset":2411},"end":{"line":125,"column":61,"offset":2415},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">date</code>","position":{"start":{"line":125,"column":61,"offset":2415},"end":{"line":125,"column":67,"offset":2421},"indent":[]}},{"type":"text","value":"函数被定义在了","position":{"start":{"line":125,"column":67,"offset":2421},"end":{"line":125,"column":74,"offset":2428},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">user.h</code>","position":{"start":{"line":125,"column":74,"offset":2428},"end":{"line":125,"column":82,"offset":2436},"indent":[]}},{"type":"text","value":"头文件中，","position":{"start":{"line":125,"column":82,"offset":2436},"end":{"line":125,"column":87,"offset":2441},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">user.h</code>","position":{"start":{"line":125,"column":87,"offset":2441},"end":{"line":125,"column":95,"offset":2449},"indent":[]}},{"type":"text","value":"的函数中的system call都是由","position":{"start":{"line":125,"column":95,"offset":2449},"end":{"line":125,"column":114,"offset":2468},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">usys.S</code>","position":{"start":{"line":125,"column":114,"offset":2468},"end":{"line":125,"column":122,"offset":2476},"indent":[]}},{"type":"text","value":"实现的，实现的方式就是调用了一个叫","position":{"start":{"line":125,"column":122,"offset":2476},"end":{"line":125,"column":139,"offset":2493},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">SYSCALL(name)</code>","position":{"start":{"line":125,"column":139,"offset":2493},"end":{"line":125,"column":154,"offset":2508},"indent":[]}},{"type":"text","value":"的宏，其操作为：","position":{"start":{"line":125,"column":154,"offset":2508},"end":{"line":125,"column":162,"offset":2516},"indent":[]}}],"position":{"start":{"line":125,"column":1,"offset":2355},"end":{"line":125,"column":162,"offset":2516},"indent":[]}},{"type":"html","lang":"c","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> SYSCALL(name) \\\n  .globl name; \\\n  name: \\\n    movl $SYS_ ## name, %eax; \\\n    int $T_SYSCALL; \\\n    ret</span></code></pre></div>","position":{"start":{"line":127,"column":1,"offset":2518},"end":{"line":134,"column":4,"offset":2639},"indent":[1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"也就是会调用","position":{"start":{"line":136,"column":1,"offset":2641},"end":{"line":136,"column":7,"offset":2647},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">INT</code>","position":{"start":{"line":136,"column":7,"offset":2647},"end":{"line":136,"column":12,"offset":2652},"indent":[]}},{"type":"text","value":"指令的。","position":{"start":{"line":136,"column":12,"offset":2652},"end":{"line":136,"column":16,"offset":2656},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">make</code>","position":{"start":{"line":136,"column":16,"offset":2656},"end":{"line":136,"column":22,"offset":2662},"indent":[]}},{"type":"text","value":"了之后，我们可以看到，","position":{"start":{"line":136,"column":22,"offset":2662},"end":{"line":136,"column":33,"offset":2673},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">sh.asm</code>","position":{"start":{"line":136,"column":33,"offset":2673},"end":{"line":136,"column":41,"offset":2681},"indent":[]}},{"type":"text","value":"果然出现了","position":{"start":{"line":136,"column":41,"offset":2681},"end":{"line":136,"column":46,"offset":2686},"indent":[]}}],"position":{"start":{"line":136,"column":1,"offset":2641},"end":{"line":136,"column":46,"offset":2686},"indent":[]}},{"type":"html","lang":"assembly","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"assembly\"><pre class=\"language-assembly\"><code class=\"language-assembly\">00000db2 &lt;date&gt;:\n     db2:\tb8 16 00 00 00       \tmov    $0x16,%eax\n     db7:\tcd 40                \tint    $0x40\n     db9:\tc3                   \tret    \n     dba:\t66 90                \txchg   %ax,%ax\n     dbc:\t66 90                \txchg   %ax,%ax\n     dbe:\t66 90                \txchg   %ax,%ax</code></pre></div>","position":{"start":{"line":138,"column":1,"offset":2688},"end":{"line":146,"column":4,"offset":2996},"indent":[1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"使用","position":{"start":{"line":148,"column":1,"offset":2998},"end":{"line":148,"column":3,"offset":3000},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">INT</code>","position":{"start":{"line":148,"column":3,"offset":3000},"end":{"line":148,"column":8,"offset":3005},"indent":[]}},{"type":"text","value":"指令开始，就和note4中记录的调用","position":{"start":{"line":148,"column":8,"offset":3005},"end":{"line":148,"column":26,"offset":3023},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">write</code>","position":{"start":{"line":148,"column":26,"offset":3023},"end":{"line":148,"column":33,"offset":3030},"indent":[]}},{"type":"text","value":"一样了。在","position":{"start":{"line":148,"column":33,"offset":3030},"end":{"line":148,"column":38,"offset":3035},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">Makefile</code>","position":{"start":{"line":148,"column":38,"offset":3035},"end":{"line":148,"column":48,"offset":3045},"indent":[]}},{"type":"text","value":"中加入","position":{"start":{"line":148,"column":48,"offset":3045},"end":{"line":148,"column":51,"offset":3048},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">date.c</code>","position":{"start":{"line":148,"column":51,"offset":3048},"end":{"line":148,"column":59,"offset":3056},"indent":[]}},{"type":"text","value":"应该只是为了编译出date的二进制文件用的吧，这个我还不清楚...","position":{"start":{"line":148,"column":59,"offset":3056},"end":{"line":148,"column":92,"offset":3089},"indent":[]}}],"position":{"start":{"line":148,"column":1,"offset":2998},"end":{"line":148,"column":92,"offset":3089},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":148,"column":92,"offset":3089}}}}