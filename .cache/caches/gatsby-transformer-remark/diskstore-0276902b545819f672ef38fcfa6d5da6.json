{"expireTime":9007200818315814000,"key":"transformer-remark-markdown-ast-379e7a1b7743611e6898886cd236bbca-gatsby-remark-katexgatsby-remark-prismjs-","val":{"type":"root","children":[{"type":"paragraph","children":[{"type":"text","value":"从今天开始打算跟着MIT 6.828学习操作系统，做一下相关的lab。配置环境有点麻烦，在这里记录一下，也用来方便后人。","position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":61,"offset":61},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":61,"offset":61},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"环境","position":{"start":{"line":4,"column":4,"offset":66},"end":{"line":4,"column":6,"offset":68},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":63},"end":{"line":4,"column":6,"offset":68},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Ubuntu 18.04","position":{"start":{"line":6,"column":1,"offset":70},"end":{"line":6,"column":13,"offset":82},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":70},"end":{"line":6,"column":13,"offset":82},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"安装方式","position":{"start":{"line":8,"column":4,"offset":87},"end":{"line":8,"column":8,"offset":91},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":84},"end":{"line":8,"column":8,"offset":91},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"首先运行","position":{"start":{"line":10,"column":1,"offset":93},"end":{"line":10,"column":5,"offset":97},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":93},"end":{"line":10,"column":5,"offset":97},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ objdump -i</code></pre></div>","position":{"start":{"line":12,"column":1,"offset":99},"end":{"line":14,"column":4,"offset":123},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"如果第二行不是","position":{"start":{"line":16,"column":1,"offset":125},"end":{"line":16,"column":8,"offset":132},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">elf32-i386</code>","position":{"start":{"line":16,"column":8,"offset":132},"end":{"line":16,"column":20,"offset":144},"indent":[]}},{"type":"text","value":", 说明不是32位系统，需要安装","position":{"start":{"line":16,"column":20,"offset":144},"end":{"line":16,"column":36,"offset":160},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":125},"end":{"line":16,"column":36,"offset":160},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> gcc-multilib</code></pre></div>","position":{"start":{"line":18,"column":1,"offset":162},"end":{"line":20,"column":4,"offset":209},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"然后安装QEMU：","position":{"start":{"line":22,"column":1,"offset":211},"end":{"line":22,"column":10,"offset":220},"indent":[]}}],"position":{"start":{"line":22,"column":1,"offset":211},"end":{"line":22,"column":10,"offset":220},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> libsdl1.2-dev libtool-bin libglib2.0-dev libz-dev libpixman-1-dev\n<span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> flex bison\n<span class=\"token function\">cd</span> your/path/6.828/\n<span class=\"token function\">git</span> clone https://github.com/mit-pdos/6.828-qemu.git qemu\n<span class=\"token function\">cd</span> qemu\n./configure --disable-kvm --target-list<span class=\"token operator\">=</span><span class=\"token string\">\"i386-softmmu x86_64-softmmu\"</span> --disable-werror --python<span class=\"token operator\">=</span>/your/python2.7/interpreter/path\n<span class=\"token function\">sudo</span> <span class=\"token function\">make</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">sudo</span> <span class=\"token function\">make</span> <span class=\"token function\">install</span></code></pre></div>","position":{"start":{"line":24,"column":1,"offset":222},"end":{"line":32,"column":4,"offset":590},"indent":[1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"默认安装地址是","position":{"start":{"line":34,"column":1,"offset":592},"end":{"line":34,"column":8,"offset":599},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">/user/local/share</code>","position":{"start":{"line":34,"column":8,"offset":599},"end":{"line":34,"column":27,"offset":618},"indent":[]}},{"type":"text","value":", 如果需要更改安装地址，可自行查询MIT提供的方法，主要是在","position":{"start":{"line":34,"column":27,"offset":618},"end":{"line":34,"column":58,"offset":649},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">./config</code>","position":{"start":{"line":34,"column":58,"offset":649},"end":{"line":34,"column":68,"offset":659},"indent":[]}},{"type":"text","value":"这行加入","position":{"start":{"line":34,"column":68,"offset":659},"end":{"line":34,"column":72,"offset":663},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">--prefix</code>","position":{"start":{"line":34,"column":72,"offset":663},"end":{"line":34,"column":82,"offset":673},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":34,"column":82,"offset":673},"end":{"line":34,"column":83,"offset":674},"indent":[]}}],"position":{"start":{"line":34,"column":1,"offset":592},"end":{"line":34,"column":83,"offset":674},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"如果不知道python解释器的位置，可以运行如下代码：","position":{"start":{"line":36,"column":1,"offset":676},"end":{"line":36,"column":28,"offset":703},"indent":[]}}],"position":{"start":{"line":36,"column":1,"offset":676},"end":{"line":36,"column":28,"offset":703},"indent":[]}},{"type":"html","lang":"python","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> sys\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>executable<span class=\"token punctuation\">)</span></code></pre></div>","position":{"start":{"line":38,"column":1,"offset":705},"end":{"line":41,"column":4,"offset":751},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"安装完毕之后，下载JOS:","position":{"start":{"line":43,"column":1,"offset":753},"end":{"line":43,"column":14,"offset":766},"indent":[]}}],"position":{"start":{"line":43,"column":1,"offset":753},"end":{"line":43,"column":14,"offset":766},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">cd</span> /your/path/6.828\n<span class=\"token function\">git</span> clone https://pdos.csail.mit.edu/6.828/2018/jos.git lab\n<span class=\"token function\">cd</span> lab\n<span class=\"token function\">make</span></code></pre></div>","position":{"start":{"line":45,"column":1,"offset":768},"end":{"line":50,"column":4,"offset":871},"indent":[1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"显示内容应与lab 1相同。","position":{"start":{"line":52,"column":1,"offset":873},"end":{"line":52,"column":15,"offset":887},"indent":[]}}],"position":{"start":{"line":52,"column":1,"offset":873},"end":{"line":52,"column":15,"offset":887},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"测试QEMU：","position":{"start":{"line":54,"column":1,"offset":889},"end":{"line":54,"column":8,"offset":896},"indent":[]}}],"position":{"start":{"line":54,"column":1,"offset":889},"end":{"line":54,"column":8,"offset":896},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">cd</span> /your/path/6.828/lab\n<span class=\"token function\">make</span> qemu</code></pre></div>","position":{"start":{"line":56,"column":1,"offset":898},"end":{"line":59,"column":4,"offset":943},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"应跳出窗口，窗口显示与lab1相同。","position":{"start":{"line":61,"column":1,"offset":945},"end":{"line":61,"column":19,"offset":963},"indent":[]}}],"position":{"start":{"line":61,"column":1,"offset":945},"end":{"line":61,"column":19,"offset":963},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"连接gdb，打开两个terminal，在第一个中：","position":{"start":{"line":63,"column":1,"offset":965},"end":{"line":63,"column":26,"offset":990},"indent":[]}}],"position":{"start":{"line":63,"column":1,"offset":965},"end":{"line":63,"column":26,"offset":990},"indent":[]}},{"type":"html","lang":null,"meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">cd /your/path/6.828/lab\nmake qemu-gdb</code></pre></div>","position":{"start":{"line":65,"column":1,"offset":992},"end":{"line":68,"column":4,"offset":1037},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"应当跳出和刚刚类似的窗口，但是显示stopping。","position":{"start":{"line":70,"column":1,"offset":1039},"end":{"line":70,"column":27,"offset":1065},"indent":[]}}],"position":{"start":{"line":70,"column":1,"offset":1039},"end":{"line":70,"column":27,"offset":1065},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"在第二个中：","position":{"start":{"line":72,"column":1,"offset":1067},"end":{"line":72,"column":7,"offset":1073},"indent":[]}}],"position":{"start":{"line":72,"column":1,"offset":1067},"end":{"line":72,"column":7,"offset":1073},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">cd</span> your/path/6.828/lab\ngdb</code></pre></div>","position":{"start":{"line":74,"column":1,"offset":1075},"end":{"line":77,"column":4,"offset":1113},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"注意第一次运行的时候gdb会提示把某一行加入","position":{"start":{"line":79,"column":1,"offset":1115},"end":{"line":79,"column":23,"offset":1137},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">~/.gdbinit</code>","position":{"start":{"line":79,"column":23,"offset":1137},"end":{"line":79,"column":35,"offset":1149},"indent":[]}},{"type":"text","value":"中，其内容类似","position":{"start":{"line":79,"column":35,"offset":1149},"end":{"line":79,"column":42,"offset":1156},"indent":[]}}],"position":{"start":{"line":79,"column":1,"offset":1115},"end":{"line":79,"column":42,"offset":1156},"indent":[]}},{"type":"html","lang":null,"meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">add-auto-load-safe-path /your/path/6.828/xv6-public/.gdbinit</code></pre></div>","position":{"start":{"line":81,"column":1,"offset":1158},"end":{"line":83,"column":4,"offset":1226},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"加入后重新进行上面的操作（重新打开两个terminal并运行指令），会发现在gdb的文字提示中出现：","position":{"start":{"line":85,"column":1,"offset":1228},"end":{"line":85,"column":51,"offset":1278},"indent":[]}}],"position":{"start":{"line":85,"column":1,"offset":1228},"end":{"line":85,"column":51,"offset":1278},"indent":[]}},{"type":"html","lang":null,"meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">+ target remote localhost:26000</code></pre></div>","position":{"start":{"line":87,"column":1,"offset":1280},"end":{"line":89,"column":4,"offset":1319},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"就说明连接成功，可以继续用lab1测试其内容是否正确。","position":{"start":{"line":91,"column":1,"offset":1321},"end":{"line":91,"column":28,"offset":1348},"indent":[]}}],"position":{"start":{"line":91,"column":1,"offset":1321},"end":{"line":91,"column":28,"offset":1348},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":91,"column":28,"offset":1348}}}}