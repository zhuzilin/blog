{"expireTime":9007200818315814000,"key":"transformer-remark-markdown-html-ast-60e003eaf8fd6a5fa93c5faf5ec9bc0f-gatsby-remark-katexgatsby-remark-prismjs-","val":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"这里会记录阅读6.828课程lecture note的我的个人笔记。可能会中英混杂，不是很适合外人阅读，也请见谅。","position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":58,"offset":58}}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":58,"offset":58}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Lecture 3: C and gdb","position":{"start":{"line":4,"column":4,"offset":63},"end":{"line":4,"column":24,"offset":83}}}],"position":{"start":{"line":4,"column":1,"offset":60},"end":{"line":4,"column":24,"offset":83}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"这一讲基本上都是介绍工具，就不在此记录了，C的部分可以看K&R，gdb的部分可以直接搜课件。","position":{"start":{"line":6,"column":1,"offset":85},"end":{"line":6,"column":47,"offset":131}}},{"type":"raw","value":"<code class=\"language-text\">pointer.c</code>","position":{"start":{"line":6,"column":47,"offset":131},"end":{"line":6,"column":58,"offset":142}}},{"type":"text","value":"的例子应该在lab1中已经进行了解释。","position":{"start":{"line":6,"column":58,"offset":142},"end":{"line":6,"column":77,"offset":161}}}],"position":{"start":{"line":6,"column":1,"offset":85},"end":{"line":6,"column":77,"offset":161}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Lecture 4: Shell & OS organization","position":{"start":{"line":8,"column":4,"offset":166},"end":{"line":8,"column":38,"offset":200}}}],"position":{"start":{"line":8,"column":1,"offset":163},"end":{"line":8,"column":38,"offset":200}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Lecture Topic","position":{"start":{"line":10,"column":5,"offset":206},"end":{"line":10,"column":18,"offset":219}}}],"position":{"start":{"line":10,"column":1,"offset":202},"end":{"line":10,"column":18,"offset":219}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"kernel syystem call API","position":{"start":{"line":12,"column":3,"offset":223},"end":{"line":12,"column":26,"offset":246}}}],"position":{"start":{"line":12,"column":3,"offset":223},"end":{"line":12,"column":26,"offset":246}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"细节与设计","position":{"start":{"line":13,"column":5,"offset":251},"end":{"line":13,"column":10,"offset":256}}}],"position":{"start":{"line":13,"column":3,"offset":249},"end":{"line":13,"column":10,"offset":256}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"isolation, multiplexing and sharing.","position":{"start":{"line":14,"column":5,"offset":261},"end":{"line":14,"column":41,"offset":297}}}],"position":{"start":{"line":14,"column":3,"offset":259},"end":{"line":14,"column":41,"offset":297}}},{"type":"text","value":"\n"}],"position":{"start":{"line":13,"column":3,"offset":249},"end":{"line":14,"column":41,"offset":297}}},{"type":"text","value":"\n"}],"position":{"start":{"line":12,"column":1,"offset":221},"end":{"line":14,"column":41,"offset":297}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"通过hw2来进行说明。","position":{"start":{"line":15,"column":3,"offset":300},"end":{"line":15,"column":14,"offset":311}}}],"position":{"start":{"line":15,"column":1,"offset":298},"end":{"line":15,"column":14,"offset":311}}},{"type":"text","value":"\n"}],"position":{"start":{"line":12,"column":1,"offset":221},"end":{"line":15,"column":14,"offset":311}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Overview Diagram","position":{"start":{"line":17,"column":5,"offset":317},"end":{"line":17,"column":21,"offset":333}}}],"position":{"start":{"line":17,"column":1,"offset":313},"end":{"line":17,"column":21,"offset":333}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"user / kernel","position":{"start":{"line":19,"column":3,"offset":337},"end":{"line":19,"column":16,"offset":350}}}],"position":{"start":{"line":19,"column":1,"offset":335},"end":{"line":19,"column":16,"offset":350}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"process = address space + thread(s)，就是一个运行中的程序","position":{"start":{"line":20,"column":3,"offset":353},"end":{"line":20,"column":49,"offset":399}}}],"position":{"start":{"line":20,"column":1,"offset":351},"end":{"line":20,"column":49,"offset":399}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"raw","value":"<code class=\"language-text\">app -&gt; printf() -&gt; write() -&gt; SYSTEM CALL -&gt; sys_write() -&gt; ...</code>","position":{"start":{"line":21,"column":3,"offset":402},"end":{"line":21,"column":68,"offset":467}}}],"position":{"start":{"line":21,"column":1,"offset":400},"end":{"line":21,"column":68,"offset":467}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"user-level library是每个app自己的东西","position":{"start":{"line":22,"column":3,"offset":470},"end":{"line":22,"column":32,"offset":499}}}],"position":{"start":{"line":22,"column":1,"offset":468},"end":{"line":22,"column":32,"offset":499}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"而kernel internal function不能被用户调用","position":{"start":{"line":23,"column":3,"offset":502},"end":{"line":23,"column":35,"offset":534}}}],"position":{"start":{"line":23,"column":1,"offset":500},"end":{"line":23,"column":35,"offset":534}}},{"type":"text","value":"\n"}],"position":{"start":{"line":19,"column":1,"offset":335},"end":{"line":23,"column":35,"offset":534}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"回顾作业（这部分就直接放在hw xv6 shell的那篇里面讲了，就不在这里赘述）。","position":{"start":{"line":25,"column":1,"offset":536},"end":{"line":25,"column":43,"offset":578}}}],"position":{"start":{"line":25,"column":1,"offset":536},"end":{"line":25,"column":43,"offset":578}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"UNIX system call observation","position":{"start":{"line":27,"column":5,"offset":584},"end":{"line":27,"column":33,"offset":612}}}],"position":{"start":{"line":27,"column":1,"offset":580},"end":{"line":27,"column":33,"offset":612}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"fork/exec看起来很浪费，因为需要先复制parent的内存到child，之后再用exec替代。为什么不合二为一呢？","position":{"start":{"line":29,"column":3,"offset":616},"end":{"line":29,"column":63,"offset":676}}}],"position":{"start":{"line":29,"column":3,"offset":616},"end":{"line":29,"column":63,"offset":676}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"因为分开非常方便。同时实际上因为使用了一些技巧，","position":{"start":{"line":31,"column":3,"offset":680},"end":{"line":31,"column":27,"offset":704}}},{"type":"raw","value":"<code class=\"language-text\">fork</code>","position":{"start":{"line":31,"column":27,"offset":704},"end":{"line":31,"column":33,"offset":710}}},{"type":"text","value":"的开销很小。","position":{"start":{"line":31,"column":33,"offset":710},"end":{"line":31,"column":39,"offset":716}}}],"position":{"start":{"line":31,"column":3,"offset":680},"end":{"line":31,"column":39,"offset":716}}},{"type":"text","value":"\n"}],"position":{"start":{"line":29,"column":1,"offset":614},"end":{"line":32,"column":1,"offset":717}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"file descriptor设计","position":{"start":{"line":33,"column":3,"offset":720},"end":{"line":33,"column":20,"offset":737}}}],"position":{"start":{"line":33,"column":3,"offset":720},"end":{"line":33,"column":20,"offset":737}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"FDs are a level of indirection。","position":{"start":{"line":35,"column":3,"offset":741},"end":{"line":35,"column":34,"offset":772}}}],"position":{"start":{"line":35,"column":3,"offset":741},"end":{"line":35,"column":34,"offset":772}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"真正的I/O环境被藏在内核里了。","position":{"start":{"line":37,"column":5,"offset":778},"end":{"line":37,"column":21,"offset":794}}}],"position":{"start":{"line":37,"column":3,"offset":776},"end":{"line":37,"column":21,"offset":794}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"通过fork, exec进行保留。","position":{"start":{"line":38,"column":5,"offset":799},"end":{"line":38,"column":22,"offset":816}}}],"position":{"start":{"line":38,"column":3,"offset":797},"end":{"line":38,"column":22,"offset":816}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"imagine writefile(filename, offset, buf size) (这啥意思。。。)","position":{"start":{"line":39,"column":5,"offset":821},"end":{"line":39,"column":60,"offset":876}}}],"position":{"start":{"line":39,"column":3,"offset":819},"end":{"line":39,"column":60,"offset":876}}},{"type":"text","value":"\n"}],"position":{"start":{"line":37,"column":3,"offset":776},"end":{"line":39,"column":60,"offset":876}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"FD统一了console, pipe和files的接口","position":{"start":{"line":41,"column":3,"offset":880},"end":{"line":41,"column":30,"offset":907}}}],"position":{"start":{"line":41,"column":3,"offset":880},"end":{"line":41,"column":30,"offset":907}}},{"type":"text","value":"\n"}],"position":{"start":{"line":33,"column":1,"offset":718},"end":{"line":42,"column":1,"offset":908}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"整体的设计哲学：用简洁的接口相互组合实现复杂功能。","position":{"start":{"line":43,"column":3,"offset":911},"end":{"line":43,"column":28,"offset":936}}}],"position":{"start":{"line":43,"column":1,"offset":909},"end":{"line":44,"column":1,"offset":937}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"为什么kernel需要pip而不用一个临时文件进行redirect:","position":{"start":{"line":45,"column":3,"offset":940},"end":{"line":45,"column":37,"offset":974}}}],"position":{"start":{"line":45,"column":3,"offset":940},"end":{"line":45,"column":37,"offset":974}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"pipe有如下四点优势：","position":{"start":{"line":47,"column":3,"offset":978},"end":{"line":47,"column":15,"offset":990}}}],"position":{"start":{"line":47,"column":3,"offset":978},"end":{"line":47,"column":15,"offset":990}}},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"pipes automatically clean themselves up; with the file redirection, a shell would have to be\ncareful to remove /tmp/xyz when done. ","position":{"start":{"line":49,"column":6,"offset":997},"end":{"line":50,"column":44,"offset":1133}}}],"position":{"start":{"line":49,"column":4,"offset":995},"end":{"line":51,"column":4,"offset":1137}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"pipes can pass arbitrarily long streams of data, while file redirection requires enough free space on disk to store all the data. (这也是为什么pipe需要多个指令同时执行)","position":{"start":{"line":52,"column":6,"offset":1143},"end":{"line":52,"column":158,"offset":1295}}}],"position":{"start":{"line":52,"column":4,"offset":1141},"end":{"line":53,"column":4,"offset":1299}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"pipes allow for parallel execution of pipeline stages, while the file approach requires the first program to finish before the second starts. ","position":{"start":{"line":54,"column":6,"offset":1305},"end":{"line":54,"column":148,"offset":1447}}}],"position":{"start":{"line":54,"column":4,"offset":1303},"end":{"line":55,"column":4,"offset":1451}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"if you are implementing inter-process communication, pipes’ blocking reads and writes are more efficient than the non-blocking semantics of files.","position":{"start":{"line":56,"column":6,"offset":1457},"end":{"line":56,"column":152,"offset":1603}}}],"position":{"start":{"line":56,"column":4,"offset":1455},"end":{"line":56,"column":152,"offset":1603}}},{"type":"text","value":"\n"}],"position":{"start":{"line":49,"column":4,"offset":995},"end":{"line":56,"column":152,"offset":1603}}},{"type":"text","value":"\n"}],"position":{"start":{"line":49,"column":3,"offset":994},"end":{"line":56,"column":152,"offset":1603}}},{"type":"text","value":"\n"}],"position":{"start":{"line":45,"column":1,"offset":938},"end":{"line":57,"column":1,"offset":1604}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"为什么kernel的system call只用int char作为buffer，而不用一个pointer指向kernel file object?","position":{"start":{"line":58,"column":3,"offset":1607},"end":{"line":58,"column":76,"offset":1680}}}],"position":{"start":{"line":58,"column":3,"offset":1607},"end":{"line":58,"column":76,"offset":1680}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"我不确定这个是为什么，感觉就是为了isolation吧，如果给一个pointer，那用户就很容易把kernel代码搞崩。","position":{"start":{"line":60,"column":3,"offset":1684},"end":{"line":60,"column":63,"offset":1744}}}],"position":{"start":{"line":60,"column":3,"offset":1684},"end":{"line":60,"column":63,"offset":1744}}},{"type":"text","value":"\n"}],"position":{"start":{"line":58,"column":1,"offset":1605},"end":{"line":61,"column":1,"offset":1745}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"核心的unix system call已经很古老了，have they held up well?","position":{"start":{"line":62,"column":3,"offset":1748},"end":{"line":62,"column":52,"offset":1797}}}],"position":{"start":{"line":62,"column":3,"offset":1748},"end":{"line":62,"column":52,"offset":1797}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"yes, very successful!","position":{"start":{"line":64,"column":3,"offset":1801},"end":{"line":64,"column":24,"offset":1822}}}],"position":{"start":{"line":64,"column":3,"offset":1801},"end":{"line":64,"column":24,"offset":1822}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"不过UNIX的一些地方不是完美的：","position":{"start":{"line":66,"column":3,"offset":1826},"end":{"line":66,"column":20,"offset":1843}}}],"position":{"start":{"line":66,"column":3,"offset":1826},"end":{"line":66,"column":20,"offset":1843}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"很多时候system call并不需要很方便程序员使用，因为会被包装。","position":{"start":{"line":68,"column":5,"offset":1849},"end":{"line":68,"column":40,"offset":1884}}}],"position":{"start":{"line":68,"column":3,"offset":1847},"end":{"line":68,"column":40,"offset":1884}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"apps may have little to do with files &c, e.g. on smartphon （这个没懂。。。）","position":{"start":{"line":69,"column":5,"offset":1889},"end":{"line":69,"column":74,"offset":1958}}}],"position":{"start":{"line":69,"column":3,"offset":1887},"end":{"line":69,"column":74,"offset":1958}}},{"type":"text","value":"\n"}],"position":{"start":{"line":68,"column":3,"offset":1847},"end":{"line":69,"column":74,"offset":1958}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"一些UNIX abstractions不够高效：","position":{"start":{"line":71,"column":3,"offset":1962},"end":{"line":71,"column":27,"offset":1986}}}],"position":{"start":{"line":71,"column":3,"offset":1962},"end":{"line":71,"column":27,"offset":1986}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"几个G的进程fork起来就很慢了","position":{"start":{"line":73,"column":5,"offset":1992},"end":{"line":73,"column":21,"offset":2008}}}],"position":{"start":{"line":73,"column":3,"offset":1990},"end":{"line":73,"column":21,"offset":2008}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"FD隐藏了一些可能很重要的细节内容，如硬盘上的block size，网络数据的timing and size (这两个应该都是被buffer给盖住了)","position":{"start":{"line":74,"column":5,"offset":2013},"end":{"line":74,"column":80,"offset":2088}}}],"position":{"start":{"line":74,"column":3,"offset":2011},"end":{"line":74,"column":80,"offset":2088}}},{"type":"text","value":"\n"}],"position":{"start":{"line":73,"column":3,"offset":1990},"end":{"line":74,"column":80,"offset":2088}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"所以一直都有备用方案：","position":{"start":{"line":76,"column":3,"offset":2092},"end":{"line":76,"column":14,"offset":2103}}}],"position":{"start":{"line":76,"column":3,"offset":2092},"end":{"line":76,"column":14,"offset":2103}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"有的是一些新的system call","position":{"start":{"line":78,"column":5,"offset":2109},"end":{"line":78,"column":23,"offset":2127}}}],"position":{"start":{"line":78,"column":3,"offset":2107},"end":{"line":78,"column":23,"offset":2127}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"有的就是完全抛弃UNIX的这一套另起炉灶。","position":{"start":{"line":79,"column":5,"offset":2132},"end":{"line":79,"column":26,"offset":2153}}}],"position":{"start":{"line":79,"column":3,"offset":2130},"end":{"line":79,"column":26,"offset":2153}}},{"type":"text","value":"\n"}],"position":{"start":{"line":78,"column":3,"offset":2107},"end":{"line":79,"column":26,"offset":2153}}},{"type":"text","value":"\n"}],"position":{"start":{"line":62,"column":1,"offset":1746},"end":{"line":79,"column":26,"offset":2153}}},{"type":"text","value":"\n"}],"position":{"start":{"line":29,"column":1,"offset":614},"end":{"line":79,"column":26,"offset":2153}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"OS organization","position":{"start":{"line":81,"column":5,"offset":2159},"end":{"line":81,"column":20,"offset":2174}}}],"position":{"start":{"line":81,"column":1,"offset":2155},"end":{"line":81,"column":20,"offset":2174}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"这部分最好先阅读一下xv6 book的第一章。","position":{"start":{"line":83,"column":1,"offset":2176},"end":{"line":83,"column":24,"offset":2199}}}],"position":{"start":{"line":83,"column":1,"offset":2176},"end":{"line":83,"column":24,"offset":2199}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"OS的主要目的之一是进行isolation。","position":{"start":{"line":85,"column":1,"offset":2201},"end":{"line":85,"column":23,"offset":2223}}}],"position":{"start":{"line":85,"column":1,"offset":2201},"end":{"line":85,"column":23,"offset":2223}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"处理器提供了user mode和kernel mode，前者不能处理privileged instructions","position":{"start":{"line":87,"column":3,"offset":2227},"end":{"line":87,"column":60,"offset":2284}}}],"position":{"start":{"line":87,"column":1,"offset":2225},"end":{"line":87,"column":60,"offset":2284}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"OS是运行在kernel mode的","position":{"start":{"line":88,"column":3,"offset":2287},"end":{"line":88,"column":21,"offset":2305}}}],"position":{"start":{"line":88,"column":1,"offset":2285},"end":{"line":88,"column":21,"offset":2305}}},{"type":"text","value":"\n"}],"position":{"start":{"line":87,"column":1,"offset":2225},"end":{"line":88,"column":21,"offset":2305}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"monolithic kernel","position":{"start":{"line":90,"column":1,"offset":2307},"end":{"line":90,"column":18,"offset":2324}}}],"position":{"start":{"line":90,"column":1,"offset":2307},"end":{"line":90,"column":18,"offset":2324}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"img","properties":{"src":"https://upload.wikimedia.org/wikipedia/commons/7/78/Kernel-monolithic_zh.svg","alt":"monolithic kernel"},"children":[],"position":{"start":{"line":92,"column":1,"offset":2326},"end":{"line":92,"column":99,"offset":2424}}}],"position":{"start":{"line":92,"column":1,"offset":2326},"end":{"line":92,"column":99,"offset":2424}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"xv6用了一种传统的设计，monolithic kernel，也就是OS完全运行于kernel mode","position":{"start":{"line":94,"column":3,"offset":2428},"end":{"line":94,"column":55,"offset":2480}}}],"position":{"start":{"line":94,"column":1,"offset":2426},"end":{"line":94,"column":55,"offset":2480}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"kernel interface == system call interface","position":{"start":{"line":95,"column":3,"offset":2483},"end":{"line":95,"column":44,"offset":2524}}}],"position":{"start":{"line":95,"column":1,"offset":2481},"end":{"line":95,"column":44,"offset":2524}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"这样的有点是方便子系统相互协调，缺点是子系统之间的interaction会很复杂，也就bug prone","position":{"start":{"line":96,"column":3,"offset":2527},"end":{"line":96,"column":55,"offset":2579}}}],"position":{"start":{"line":96,"column":1,"offset":2525},"end":{"line":96,"column":55,"offset":2579}}},{"type":"text","value":"\n"}],"position":{"start":{"line":94,"column":1,"offset":2426},"end":{"line":96,"column":55,"offset":2579}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"microkernel design","position":{"start":{"line":98,"column":1,"offset":2581},"end":{"line":98,"column":19,"offset":2599}}}],"position":{"start":{"line":98,"column":1,"offset":2581},"end":{"line":98,"column":19,"offset":2599}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"img","properties":{"src":"https://upload.wikimedia.org/wikipedia/commons/6/67/OS-structure.svg","alt":"microkernel"},"children":[],"position":{"start":{"line":100,"column":1,"offset":2601},"end":{"line":100,"column":85,"offset":2685}}}],"position":{"start":{"line":100,"column":1,"offset":2601},"end":{"line":100,"column":85,"offset":2685}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"另外一种设计，让OS作为一个普通的user program。如file system再一个file server里。","position":{"start":{"line":102,"column":3,"offset":2689},"end":{"line":102,"column":61,"offset":2747}}}],"position":{"start":{"line":102,"column":1,"offset":2687},"end":{"line":102,"column":61,"offset":2747}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"kernel implements minimal mechanism to run services in user space processes with memory 如IPC","position":{"start":{"line":103,"column":3,"offset":2750},"end":{"line":103,"column":95,"offset":2842}}}],"position":{"start":{"line":103,"column":1,"offset":2748},"end":{"line":103,"column":95,"offset":2842}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"kernel interface != system call interface","position":{"start":{"line":104,"column":3,"offset":2845},"end":{"line":104,"column":44,"offset":2886}}}],"position":{"start":{"line":104,"column":1,"offset":2843},"end":{"line":104,"column":44,"offset":2886}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"好处是isolation更好了","position":{"start":{"line":105,"column":3,"offset":2889},"end":{"line":105,"column":18,"offset":2904}}}],"position":{"start":{"line":105,"column":1,"offset":2887},"end":{"line":105,"column":18,"offset":2904}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"坏处是性能会比较差","position":{"start":{"line":106,"column":3,"offset":2907},"end":{"line":106,"column":12,"offset":2916}}}],"position":{"start":{"line":106,"column":1,"offset":2905},"end":{"line":106,"column":12,"offset":2916}}},{"type":"text","value":"\n"}],"position":{"start":{"line":102,"column":1,"offset":2687},"end":{"line":106,"column":12,"offset":2916}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"exokernel","position":{"start":{"line":108,"column":1,"offset":2918},"end":{"line":108,"column":10,"offset":2927}}}],"position":{"start":{"line":108,"column":1,"offset":2918},"end":{"line":108,"column":10,"offset":2927}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"img","properties":{"src":"https://upload.wikimedia.org/wikipedia/commons/1/14/Exokernel.svg","alt":"exokernel"},"children":[],"position":{"start":{"line":110,"column":1,"offset":2929},"end":{"line":110,"column":80,"offset":3008}}}],"position":{"start":{"line":110,"column":1,"offset":2929},"end":{"line":110,"column":80,"offset":3008}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"apps可以semi-directly使用","position":{"start":{"line":112,"column":3,"offset":3012},"end":{"line":112,"column":24,"offset":3033}}}],"position":{"start":{"line":112,"column":3,"offset":3012},"end":{"line":112,"column":24,"offset":3033}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"apps can use hardware semi-directly, but O/S isolates\ne.g. app can read/write own page table, but O/S audits\ne.g. app can read/write disk blocks, but O/S tracks block owners\ngood: more flexibility for demanding applications\njos will be a mix of microkernel and exokernel","position":{"start":{"line":114,"column":3,"offset":3037},"end":{"line":118,"column":53,"offset":3331}}}],"position":{"start":{"line":114,"column":3,"offset":3037},"end":{"line":118,"column":53,"offset":3331}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"（这里不是很明白，可能写完JOS作业就懂了...）","position":{"start":{"line":120,"column":3,"offset":3335},"end":{"line":120,"column":28,"offset":3360}}}],"position":{"start":{"line":120,"column":3,"offset":3335},"end":{"line":120,"column":28,"offset":3360}}},{"type":"text","value":"\n"}],"position":{"start":{"line":112,"column":1,"offset":3010},"end":{"line":120,"column":28,"offset":3360}}},{"type":"text","value":"\n"}],"position":{"start":{"line":112,"column":1,"offset":3010},"end":{"line":120,"column":28,"offset":3360}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"之后会有不适用硬件支撑kernel/user mode的isolation，叫Singularity O/S，之后的课中会讲到。","position":{"start":{"line":122,"column":1,"offset":3362},"end":{"line":122,"column":65,"offset":3426}}}],"position":{"start":{"line":122,"column":1,"offset":3362},"end":{"line":122,"column":65,"offset":3426}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":122,"column":65,"offset":3426}}}}