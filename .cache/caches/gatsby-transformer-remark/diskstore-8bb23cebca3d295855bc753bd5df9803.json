{"expireTime":9007200818315814000,"key":"transformer-remark-markdown-ast-d155fbf538b44d3fcff667e968df7f0f-gatsby-remark-katexgatsby-remark-prismjs-","val":{"type":"root","children":[{"type":"paragraph","children":[{"type":"text","value":"D3.js is a popular package for data visualization. It provides great freedom for designer and data scientists to show data. This time, we are trying to add D3 to Hexo to write blog with nice visualization.","position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":1,"column":206,"offset":205},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":1,"column":206,"offset":205},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Add javascript to Hexo","position":{"start":{"line":3,"column":4,"offset":210},"end":{"line":3,"column":26,"offset":232},"indent":[]}}],"position":{"start":{"line":3,"column":1,"offset":207},"end":{"line":3,"column":26,"offset":232},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"In fact, adding D3 to Hexo is just adding javascript code to markdown in Hexo. In the documentation of  Hexo, it tells us a way to add the html code using ","position":{"start":{"line":5,"column":1,"offset":234},"end":{"line":5,"column":156,"offset":389},"indent":[]}},{"type":"link","title":null,"url":"https://hexo.io/docs/tag-plugins.html#Raw","children":[{"type":"text","value":"raw","position":{"start":{"line":5,"column":157,"offset":390},"end":{"line":5,"column":160,"offset":393},"indent":[]}}],"position":{"start":{"line":5,"column":156,"offset":389},"end":{"line":5,"column":204,"offset":437},"indent":[]}},{"type":"text","value":":","position":{"start":{"line":5,"column":204,"offset":437},"end":{"line":5,"column":205,"offset":438},"indent":[]}}],"position":{"start":{"line":5,"column":1,"offset":234},"end":{"line":5,"column":205,"offset":438},"indent":[]}},{"type":"html","lang":"ejs","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"ejs\"><pre class=\"language-ejs\"><code class=\"language-ejs\">{% raw %}\ncontent\n{% endraw %}</code></pre></div>","position":{"start":{"line":7,"column":1,"offset":440},"end":{"line":11,"column":4,"offset":481},"indent":[1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Add D3 to Hexo","position":{"start":{"line":13,"column":4,"offset":486},"end":{"line":13,"column":18,"offset":500},"indent":[]}}],"position":{"start":{"line":13,"column":1,"offset":483},"end":{"line":13,"column":18,"offset":500},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Therefore, we just need to add D3 code in the middle.","position":{"start":{"line":15,"column":1,"offset":502},"end":{"line":15,"column":54,"offset":555},"indent":[]}}],"position":{"start":{"line":15,"column":1,"offset":502},"end":{"line":15,"column":54,"offset":555},"indent":[]}},{"type":"html","lang":"html","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>d3js-example-content<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>  \n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>https://d3js.org/d3.v4.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n\n<span class=\"token keyword\">let</span> svg <span class=\"token operator\">=</span> d3<span class=\"token punctuation\">.</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#d3js-example-content\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"svg\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"width\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"400\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"height\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"400\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\n    <span class=\"token operator\">...</span> <span class=\"token operator\">...</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></code></pre></div>","position":{"start":{"line":17,"column":1,"offset":557},"end":{"line":31,"column":4,"offset":816},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Here is a demo.","position":{"start":{"line":33,"column":1,"offset":818},"end":{"line":33,"column":16,"offset":833},"indent":[]}}],"position":{"start":{"line":33,"column":1,"offset":818},"end":{"line":33,"column":16,"offset":833},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"{% raw %}","position":{"start":{"line":35,"column":1,"offset":835},"end":{"line":35,"column":10,"offset":844},"indent":[]}}],"position":{"start":{"line":35,"column":1,"offset":835},"end":{"line":35,"column":10,"offset":844},"indent":[]}},{"type":"html","value":"<div id=\"d3js-example-content\"></div>  ","position":{"start":{"line":37,"column":1,"offset":846},"end":{"line":37,"column":40,"offset":885},"indent":[]}},{"type":"html","value":"<script src=\"https://d3js.org/d3.v4.min.js\"></script>","position":{"start":{"line":39,"column":1,"offset":887},"end":{"line":39,"column":54,"offset":940},"indent":[]}},{"type":"html","value":"<script>\n\nlet width = 400;\nlet height = 400;\n\nlet svg = d3.select(\"#d3js-example-content\")\n    .append(\"svg\")\n    .attr(\"width\", width)\n    .attr(\"height\", height);\n\nlet padding = { left: 30, right: 30, top: 30, bottom: 20 };\n\nlet dataset = [10, 20, 30, 40, 33, 24, 12, 5];\n\nlet xScale = d3.scaleBand()\n    .domain(d3.range(dataset.length))\n    .rangeRound([0, width - padding.left - padding.right]);\n\nlet yScale = d3.scaleLinear()\n    .domain([0, d3.max(dataset)])\n    .range([height - padding.top - padding.bottom, 0]);\n\nlet xAxis = d3.axisBottom().scale(xScale);\nlet yAxis = d3.axisLeft().scale(yScale);\n\n//矩形之间的空白\nlet rectPadding = 4;\n\n//添加矩形元素\nlet rects = svg.selectAll(\".MyRect\")\n    .data(dataset)\n    .enter()\n    .append(\"rect\")\n    .attr(\"class\",\"MyRect\")\n    .attr(\"transform\",\"translate(\" + padding.left + \",\" + padding.top + \")\")\n    .attr(\"x\", function(d,i){\n        return xScale(i) + rectPadding/2;\n    } )\n    .attr(\"y\",function(d){\n        return yScale(d);\n    })\n    .attr(\"width\", xScale.bandwidth() - rectPadding )\n    .attr(\"height\", function(d){\n        return height - padding.top - padding.bottom - yScale(d);\n    })\n    .attr(\"fill\",\"#0336FF\")       //填充颜色不要写在CSS里\n   .on(\"mouseover\", function(d,i){\n        d3.select(this)\n            .attr(\"fill\",\"#FF0266\");\n    })\n    .on(\"touchenter\", function(d,i){\n        d3.select(this)\n            .attr(\"fill\",\"#FF0266\");\n    })\n    .on(\"mouseout\",function(d,i){\n        d3.select(this)\n            .transition()\n            .duration(500)\n            .attr(\"fill\",\"#0336FF\");\n    })\n    .on(\"touchleave\",function(d,i){\n        d3.select(this)\n            .transition()\n            .duration(500)\n            .attr(\"fill\",\"#0336FF\");\n    });\n\n//添加文字元素\nlet texts = svg.selectAll(\".MyText\")\n    .data(dataset)\n    .enter()\n    .append(\"text\")\n    .attr(\"class\",\"MyText\")\n    .attr(\"transform\",\"translate(\" + padding.left + \",\" + padding.top + \")\")\n    .attr(\"x\", function(d,i){\n        return xScale(i);\n    } )\n    .attr(\"y\",function(d){\n        return yScale(d);\n    })\n    .attr(\"dx\",function(){\n        return (xScale.bandwidth() - rectPadding)/2;\n    })\n    .attr(\"dy\",function(d){\n        return -5;\n    })\n    .text(function(d){\n        return d;\n    });\n\n//添加x轴\nsvg.append(\"g\")\n    .attr(\"class\",\"axis\")\n    .attr(\"transform\",\"translate(\" + padding.left + \",\" + (height - padding.bottom) + \")\")\n    .call(xAxis);\n\n//添加y轴\nsvg.append(\"g\")\n    .attr(\"class\",\"axis\")\n    .attr(\"transform\",\"translate(\" + padding.left + \",\" + padding.top + \")\")\n    .call(yAxis);\n\n</script>","position":{"start":{"line":40,"column":1,"offset":941},"end":{"line":142,"column":10,"offset":3486},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"{% endraw %}","position":{"start":{"line":144,"column":1,"offset":3488},"end":{"line":144,"column":13,"offset":3500},"indent":[]}}],"position":{"start":{"line":144,"column":1,"offset":3488},"end":{"line":144,"column":13,"offset":3500},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":144,"column":13,"offset":3500}}}}