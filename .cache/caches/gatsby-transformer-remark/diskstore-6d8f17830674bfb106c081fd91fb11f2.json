{"expireTime":9007200818315814000,"key":"transformer-remark-markdown-ast-574b58c4ff53bc1030d1ee8abebb5a78-gatsby-remark-katexgatsby-remark-prismjs-","val":{"type":"root","children":[{"type":"heading","depth":2,"children":[{"type":"text","value":"Relative importing is painful","position":{"start":{"line":2,"column":4,"offset":4},"end":{"line":2,"column":33,"offset":33},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":33,"offset":33},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The relative importing has always been painful in python. For example, we are writing a web app using Flask. The file structure is like following:","position":{"start":{"line":4,"column":1,"offset":35},"end":{"line":4,"column":147,"offset":181},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":35},"end":{"line":4,"column":147,"offset":181},"indent":[]}},{"type":"html","lang":null,"meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">\\root\n\trun.py\n\t\\views\n\t\tblueprint.py</code></pre></div>","position":{"start":{"line":6,"column":1,"offset":183},"end":{"line":11,"column":4,"offset":227},"indent":[1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"To use websocket, we have chosen the flask-socketio. In the run.py and our blueprint file, we all need the socketio variable. It is natural for one to write the following code:","position":{"start":{"line":13,"column":1,"offset":229},"end":{"line":13,"column":177,"offset":405},"indent":[]}}],"position":{"start":{"line":13,"column":1,"offset":229},"end":{"line":13,"column":177,"offset":405},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"In run.py","position":{"start":{"line":15,"column":1,"offset":407},"end":{"line":15,"column":10,"offset":416},"indent":[]}}],"position":{"start":{"line":15,"column":1,"offset":407},"end":{"line":15,"column":10,"offset":416},"indent":[]}},{"type":"html","lang":"python","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token keyword\">from</span> flask<span class=\"token operator\">-</span>socketio <span class=\"token keyword\">import</span> SocketIO\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\nsocketio <span class=\"token operator\">=</span> SocketIO<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">register_blueprint</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    \napp <span class=\"token operator\">=</span> Flask<span class=\"token punctuation\">(</span>__name__<span class=\"token punctuation\">)</span>\nregister_blueprint<span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">)</span>\n\nsocketio<span class=\"token punctuation\">.</span>init_app<span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></code></pre></div>","position":{"start":{"line":17,"column":1,"offset":418},"end":{"line":31,"column":4,"offset":630},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"And in blueprint.py","position":{"start":{"line":33,"column":1,"offset":632},"end":{"line":33,"column":20,"offset":651},"indent":[]}}],"position":{"start":{"line":33,"column":1,"offset":632},"end":{"line":33,"column":20,"offset":651},"indent":[]}},{"type":"html","lang":null,"meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">from ..run import socketio\n\n... ...\n@socket.on(&#39;message&#39;):\n\t... ...</code></pre></div>","position":{"start":{"line":35,"column":1,"offset":653},"end":{"line":41,"column":4,"offset":728},"indent":[1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"But this would trigger: ","position":{"start":{"line":43,"column":1,"offset":730},"end":{"line":43,"column":25,"offset":754},"indent":[]}}],"position":{"start":{"line":43,"column":1,"offset":730},"end":{"line":43,"column":25,"offset":754},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">Error: attempted relative <span class=\"token function\">import</span> beyond top-level package</code></pre></div>","position":{"start":{"line":45,"column":1,"offset":756},"end":{"line":47,"column":4,"offset":825},"indent":[1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Decent solution","position":{"start":{"line":49,"column":4,"offset":830},"end":{"line":49,"column":19,"offset":845},"indent":[]}}],"position":{"start":{"line":49,"column":1,"offset":827},"end":{"line":49,"column":19,"offset":845},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"We need to move the variable socketio to ","position":{"start":{"line":51,"column":1,"offset":847},"end":{"line":51,"column":42,"offset":888},"indent":[]}},{"type":"text","value":"_","position":{"start":{"line":51,"column":42,"offset":888},"end":{"line":51,"column":44,"offset":890},"indent":[]}},{"type":"text","value":"_","position":{"start":{"line":51,"column":44,"offset":890},"end":{"line":51,"column":46,"offset":892},"indent":[]}},{"type":"text","value":" init","position":{"start":{"line":51,"column":46,"offset":892},"end":{"line":51,"column":51,"offset":897},"indent":[]}},{"type":"text","value":"_","position":{"start":{"line":51,"column":51,"offset":897},"end":{"line":51,"column":53,"offset":899},"indent":[]}},{"type":"text","value":"_","position":{"start":{"line":51,"column":53,"offset":899},"end":{"line":51,"column":55,"offset":901},"indent":[]}},{"type":"text","value":".py. Now the file structure is:","position":{"start":{"line":51,"column":55,"offset":901},"end":{"line":51,"column":86,"offset":932},"indent":[]}}],"position":{"start":{"line":51,"column":1,"offset":847},"end":{"line":51,"column":86,"offset":932},"indent":[]}},{"type":"html","lang":null,"meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">\\root\n\trun.py\n\t\\views\n\t\t__init__.py\n\t\tblueprint.py</code></pre></div>","position":{"start":{"line":53,"column":1,"offset":934},"end":{"line":59,"column":4,"offset":992},"indent":[1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"In ","position":{"start":{"line":61,"column":1,"offset":994},"end":{"line":61,"column":4,"offset":997},"indent":[]}},{"type":"text","value":"_","position":{"start":{"line":61,"column":4,"offset":997},"end":{"line":61,"column":6,"offset":999},"indent":[]}},{"type":"text","value":"_","position":{"start":{"line":61,"column":6,"offset":999},"end":{"line":61,"column":8,"offset":1001},"indent":[]}},{"type":"text","value":" init","position":{"start":{"line":61,"column":8,"offset":1001},"end":{"line":61,"column":13,"offset":1006},"indent":[]}},{"type":"text","value":"_","position":{"start":{"line":61,"column":13,"offset":1006},"end":{"line":61,"column":15,"offset":1008},"indent":[]}},{"type":"text","value":"_","position":{"start":{"line":61,"column":15,"offset":1008},"end":{"line":61,"column":17,"offset":1010},"indent":[]}},{"type":"text","value":".py:","position":{"start":{"line":61,"column":17,"offset":1010},"end":{"line":61,"column":21,"offset":1014},"indent":[]}}],"position":{"start":{"line":61,"column":1,"offset":994},"end":{"line":61,"column":21,"offset":1014},"indent":[]}},{"type":"html","lang":"python","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">socketio <span class=\"token operator\">=</span> SocketIO<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>","position":{"start":{"line":63,"column":1,"offset":1016},"end":{"line":65,"column":4,"offset":1051},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"In run.py","position":{"start":{"line":67,"column":1,"offset":1053},"end":{"line":67,"column":10,"offset":1062},"indent":[]}}],"position":{"start":{"line":67,"column":1,"offset":1053},"end":{"line":67,"column":10,"offset":1062},"indent":[]}},{"type":"html","lang":"python","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> views <span class=\"token keyword\">import</span> socketio</code></pre></div>","position":{"start":{"line":69,"column":1,"offset":1064},"end":{"line":71,"column":4,"offset":1104},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"In blueprint.py","position":{"start":{"line":73,"column":1,"offset":1106},"end":{"line":73,"column":16,"offset":1121},"indent":[]}}],"position":{"start":{"line":73,"column":1,"offset":1106},"end":{"line":73,"column":16,"offset":1121},"indent":[]}},{"type":"html","lang":"python","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> <span class=\"token punctuation\">.</span> <span class=\"token keyword\">import</span> socketio</code></pre></div>","position":{"start":{"line":75,"column":1,"offset":1123},"end":{"line":77,"column":4,"offset":1159},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Problem solved!","position":{"start":{"line":79,"column":1,"offset":1161},"end":{"line":79,"column":16,"offset":1176},"indent":[]}}],"position":{"start":{"line":79,"column":1,"offset":1161},"end":{"line":79,"column":16,"offset":1176},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":81,"column":1,"offset":1178}}}}