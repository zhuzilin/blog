{"componentChunkName":"component---src-templates-blog-post-js","path":"/js-basic-prototype/","webpackCompilationHash":"8e732e940c81013b8aa4","result":{"data":{"markdownRemark":{"html":"<p>æœ€è¿‘å¼€å§‹åšé¢è¯•çš„å¤ä¹ ï¼Œæ‰“ç®—é¡ºä¾¿æŠŠä¸€äº›çœ‹è¿‡å¥½å¤šéçš„jsçŸ¥è¯†æ€»ç»“æç‚¼ä¸€ä¸‹ã€‚è¿™æ¬¡çš„å†…å®¹æ˜¯<code class=\"language-text\">prototype</code>ã€‚æœ¬æ–‡çš„å†…å®¹æ¥è‡ªäº<a href=\"%5Bhttps://github.com/getify/You-Dont-Know-JS/tree/master/this%20%26%20object%20prototypes%5D(https://github.com/getify/You-Dont-Know-JS/tree/master/this%20%26%20object%20prototypes)\">You Don't Know JS: <em>this</em> &#x26; Object Prototypes</a>ã€‚éå¸¸å¥½çš„ä¸€æœ¬ä¹¦ï¼Œéå¸¸æ¨èã€‚</p>\n<h2><code class=\"language-text\">[[Prototype]]</code></h2>\n<p>é¦–å…ˆæ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> anotherObject <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n\ta<span class=\"token punctuation\">:</span> <span class=\"token number\">2</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// create an object linked to `anotherObject`</span>\n<span class=\"token keyword\">var</span> myObject <span class=\"token operator\">=</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span> anotherObject <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nmyObject<span class=\"token punctuation\">.</span>a<span class=\"token punctuation\">;</span> <span class=\"token comment\">// 2</span></code></pre></div>\n<p>ï¼ˆåæ–‡ä¼šä»‹ç»<code class=\"language-text\">Object.create(..)</code>ï¼Œç°åœ¨æš‚æ—¶æŠŠå®ƒå¤§ä¼šæ›¾åˆ›å»ºäº†ä¸€ä¸ªå’Œä¼ å…¥çš„å¯¹è±¡ä»¥<code class=\"language-text\">[[Prototype]]</code>ç›¸è¿çš„å¯¹è±¡å°±å¥½ï¼‰ã€‚</p>\n<p><code class=\"language-text\">myObject</code>å’Œ<code class=\"language-text\">anotherObject</code>ä»¥<code class=\"language-text\">[[Prototype]]</code>ç›¸è¿ï¼Œè™½ç„¶<code class=\"language-text\">a</code>ä¸æ˜¯<code class=\"language-text\">myObject</code>çš„ç‰¹æ€§ï¼Œä¹Ÿé€šè¿‡prototypeé“¾è®¿é—®<code class=\"language-text\">anotherObject</code>çš„<code class=\"language-text\">a</code>è®¿é—®åˆ°äº†ã€‚</p>\n<p>å¦‚æœ<code class=\"language-text\">anotherObject</code>é‡Œé¢ä¹Ÿæ²¡æœ‰<code class=\"language-text\">a</code>ï¼Œé‚£ä¹ˆå°±ä¼šä¸€ç›´æƒ³ä¸Šæ‰¾ï¼Œå¦‚æœå§‹ç»ˆæ²¡æœ‰ï¼Œä¼šè¿”å›<code class=\"language-text\">undefined</code>ã€‚å‡ºäº†ç›´æ¥è®¿é—®ï¼Œç”¨<code class=\"language-text\">for .. in</code>è¿™æ ·çš„å¾ªç¯ï¼Œæˆ–è€…æ˜¯<code class=\"language-text\">in</code>è¿™æ ·çš„ä¸œè¥¿éƒ½å¯ä»¥è¿›è¡Œç±»ä¼¼çš„æ£€æŸ¥ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> anotherObject <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n\ta<span class=\"token punctuation\">:</span> <span class=\"token number\">2</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// create an object linked to `anotherObject`</span>\n<span class=\"token keyword\">var</span> myObject <span class=\"token operator\">=</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span> anotherObject <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> k <span class=\"token keyword\">in</span> myObject<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\tconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"found: \"</span> <span class=\"token operator\">+</span> k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// found: a</span>\n<span class=\"token punctuation\">(</span><span class=\"token string\">\"a\"</span> <span class=\"token keyword\">in</span> myObject<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// true</span>\nmyObject<span class=\"token punctuation\">.</span><span class=\"token function\">hasOwnProperty</span><span class=\"token punctuation\">(</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// false</span></code></pre></div>\n<h3>Object.prototype</h3>\n<p>åˆšåˆšæœ‰æåˆ°ï¼Œæ²¿ç€é“¾æœç´¢ä¸€ç›´åˆ°å¤´ï¼Œé‚£ä¹ˆå“ªé‡Œæ˜¯prototypeé“¾çš„å°½å¤´å‘¢ï¼Ÿ</p>\n<p>æ‰€æœ‰æ™®é€šçš„prototypeé“¾çš„å°½å¤´éƒ½æ˜¯<code class=\"language-text\">Object.prototype</code>. è¿™ä¸ªå¯¹è±¡åŒ…å«äº†å¾ˆå¤šå¸¸è§çš„å·¥å…·å‡½æ•°ï¼ŒåŒ…æ‹¬<code class=\"language-text\">toString(), valueOf()</code>ç­‰ç­‰ã€‚</p>\n<h3>Setting &#x26; Shadowing Properties</h3>\n<p>æˆ‘ä»¬æ¥è€ƒè™‘è¿™ä¸ªèµ‹å€¼ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">myObject<span class=\"token punctuation\">.</span>foo <span class=\"token operator\">=</span> <span class=\"token string\">\"bar\"</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>å¦‚æœï¼š</p>\n<ul>\n<li><code class=\"language-text\">myObject</code>æœ‰<code class=\"language-text\">foo</code>è¿™ä¸ªå±æ€§çš„è¯ï¼Œé‚£ä¹ˆç›´æ¥èµ‹å€¼</li>\n<li>\n<p><code class=\"language-text\">foo</code>ä¸åœ¨<code class=\"language-text\">myObject</code>ä¸Š</p>\n<ul>\n<li>è€Œä¸”ä¸åœ¨prototypeé“¾ä¸Šçš„ä»»ä½•ä¸€ä¸ªå¯¹è±¡ä¸Šï¼Œé‚£ä¹ˆå°±åœ¨myObjectä¸Šç›´æ¥åˆ›å»ºä¸€ä¸ª<code class=\"language-text\">foo</code>å±æ€§ã€‚</li>\n<li>åœ¨<code class=\"language-text\">prototype</code>ä¸Šæ‰¾åˆ°äº†éœ€è¦å•ç‹¬è®¨è®ºã€‚</li>\n</ul>\n</li>\n</ul>\n<p>å¦‚æœ<code class=\"language-text\">foo</code>æ—¢åœ¨<code class=\"language-text\">myObject</code>ä¸Šï¼Œä¹Ÿåœ¨prototypeé“¾çš„ä¸Šæ›´é«˜çš„ä¸€å¤„ï¼Œå°±ä¼šå‘ç”Ÿ<em>shadow</em>ã€‚ä»»ä½•å¯¹<code class=\"language-text\">foo</code>çš„è®¿é—®éƒ½ä¼šåœ¨<code class=\"language-text\">myObject.foo</code>æˆªæ­¢ã€‚è€Œshadowå¹¶ä¸æ˜¯é‚£ä¹ˆç®€å•çš„ï¼Œæˆ‘ä»¬æ¥è€ƒè™‘ä¸€ä¸‹3ä¸­æƒ…æ™¯ï¼Œ<code class=\"language-text\">myObject.foo = &quot;bar&quot;</code>ä¼šå‘ç”Ÿä»€ä¹ˆï¼ˆ<code class=\"language-text\">foo</code>ä¸åœ¨<code class=\"language-text\">myObject</code>ä¸Šï¼‰ã€‚</p>\n<ul>\n<li>å¦‚æœä¸€ä¸ªæ™®é€šçš„accessor property <code class=\"language-text\">foo</code>åœ¨é“¾çš„é«˜å¤„è¢«è®¿é—®åˆ°äº†ï¼Œå¹¶ä¸”å…¶<strong>ä¸æ˜¯</strong><code class=\"language-text\">writable: false</code>ï¼Œé‚£ä¹ˆä¸€ä¸ªæ–°çš„å±æ€§<code class=\"language-text\">foo</code>ä¼šè¢«åŠ åˆ°<code class=\"language-text\">myObject</code>ä¸Šï¼Œå½¢æˆshadow</li>\n<li>å¦‚æœä¸€ä¸ªæ™®é€šçš„accessor property <code class=\"language-text\">foo</code>åœ¨é“¾çš„é«˜å¤„è¢«è®¿é—®åˆ°äº†ï¼Œå¹¶ä¸”å…¶<strong>æ˜¯</strong><code class=\"language-text\">writable: false</code>ï¼Œé‚£ä¹ˆæ—¢ä¸ä¼šç»™è¿™ä¸ª<code class=\"language-text\">foo</code>èµ‹å€¼ï¼Œä¹Ÿä¸ä¼šç»™<code class=\"language-text\">myObject</code>æ·»åŠ å±æ€§ï¼Œä¸ä¼šå‘ç”Ÿshadowã€‚</li>\n<li>å¦‚æœä¸€ä¸ª <code class=\"language-text\">foo</code>åœ¨é“¾çš„é«˜å¤„è¢«è®¿é—®åˆ°äº†ï¼Œä¸”å®ƒæ˜¯ä¸€ä¸ªsetter(ä¹¦ch3)ï¼Œé‚£ä¹ˆä¼šè°ƒç”¨è¿™ä¸ªsetterï¼Œä¸ä¼šç»™<code class=\"language-text\">myObject</code>æ·»åŠ å±æ€§ï¼Œä¹Ÿä¸ä¼šé‡è®¾setterï¼Œä¸ä¼šå‘ç”Ÿshadowã€‚</li>\n</ul>\n<p>å¯¹äºç¬¬äºŒä¸ªæˆ–è€…ç¬¬ä¸‰ç§æƒ…å†µï¼Œå¦‚æœéœ€è¦è¿›è¡Œshadowï¼Œä¸èƒ½ç”¨<code class=\"language-text\">=</code>ï¼Œè€Œéœ€è¦ç”¨<code class=\"language-text\">Object.defineProperty(..)</code>ã€‚</p>\n<p>Shadowingå¯èƒ½åœ¨ä¸çŸ¥ä¸è§‰ä¸­å‘ç”Ÿï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> anotherObject <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n\ta<span class=\"token punctuation\">:</span> <span class=\"token number\">2</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">var</span> myObject <span class=\"token operator\">=</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span> anotherObject <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nanotherObject<span class=\"token punctuation\">.</span>a<span class=\"token punctuation\">;</span> <span class=\"token comment\">// 2</span>\nmyObject<span class=\"token punctuation\">.</span>a<span class=\"token punctuation\">;</span> <span class=\"token comment\">// 2</span>\n\nanotherObject<span class=\"token punctuation\">.</span><span class=\"token function\">hasOwnProperty</span><span class=\"token punctuation\">(</span> <span class=\"token string\">\"a\"</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// true</span>\nmyObject<span class=\"token punctuation\">.</span><span class=\"token function\">hasOwnProperty</span><span class=\"token punctuation\">(</span> <span class=\"token string\">\"a\"</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// false</span>\n\nmyObject<span class=\"token punctuation\">.</span>a<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// oops, implicit shadowing!</span>\n\nanotherObject<span class=\"token punctuation\">.</span>a<span class=\"token punctuation\">;</span> <span class=\"token comment\">// 2</span>\nmyObject<span class=\"token punctuation\">.</span>a<span class=\"token punctuation\">;</span> <span class=\"token comment\">// 3</span>\n\nmyObject<span class=\"token punctuation\">.</span><span class=\"token function\">hasOwnProperty</span><span class=\"token punctuation\">(</span> <span class=\"token string\">\"a\"</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// true</span></code></pre></div>\n<h2>\"Class\"</h2>\n<p>ä¸Šé¢ç®€å•çš„æåŠäº†ä¸€ä¸‹prototypeé“¾ï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œä¸ºä»€ä¹ˆéœ€è¦è¿™ä¹ˆä¸€ä¸ªé“¾å‘¢ï¼Ÿå’Œ<code class=\"language-text\">this</code>çš„æ—¶å€™ä¸€æ ·ï¼Œè¦å¼„æ‡‚è¿™ä¸ªé—®é¢˜å°±è¦å…ˆå¼„æ‡‚prototypeä¸æ˜¯ä»€ä¹ˆã€‚</p>\n<p>javascriptå®é™…ä¸Šæ˜¯æ²¡æœ‰ç±»(class)è¿™ä¹ˆä¸ªä¸œè¥¿çš„ã€‚ç„¶è€Œå¾ˆå¤šå¹´æ¥ï¼Œjséƒ½åœ¨ç”¨ä¸€ç§å¥‡æ€ªçš„æ–¹å¼å»å°è¯•å®ç°classã€‚</p>\n<h3>â€œClassâ€ Functions</h3>\n<p>è¿™ç§å¥‡æ€ªçš„æ–¹å¼å¯„æ‰˜äºå‡½æ•°çš„ä¸€ä¸ªå¥‡æ€ªçš„å±æ€§ï¼šæ‰€æœ‰å‡½æ•°éƒ½ä¼šæœ‰ä¸€ä¸ªå«<code class=\"language-text\">prototype</code>çš„å±æ€§ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">Foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// all objects created by new Foo() is [[Prototype]]-linked to Foo.prototype</span>\n<span class=\"token keyword\">var</span> a <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nObject<span class=\"token punctuation\">.</span><span class=\"token function\">getPrototypeOf</span><span class=\"token punctuation\">(</span> a <span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token class-name\">Foo</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">;</span> <span class=\"token comment\">// true</span></code></pre></div>\n<p>å½“<code class=\"language-text\">a</code>è¢«åˆ›å»ºçš„æ—¶å€™ï¼Œ<code class=\"language-text\">a</code>ä¼šå¾—åˆ°ä¸€ä¸ªinternal <code class=\"language-text\">[[Prototype]]</code> linkåˆ°<code class=\"language-text\">Foo.prototype</code>ã€‚</p>\n<p>å¯¹æ¯”class-oriented languageï¼Œä¸€ä¸ªç±»å¯ä»¥åˆ›å»ºå¤šä¸ªå®ä½“ï¼ˆinstanceï¼‰ã€‚ä½†åœ¨jsä¸­ï¼Œæ²¡æœ‰å¤åˆ¶çš„è¿‡ç¨‹ï¼Œåªæœ‰linkã€‚</p>\n<p><a href=\"https://github.com/getify/You-Dont-Know-JS/blob/master/this%20%26%20object%20prototypes/fig3.png\"><img src=\"https://github.com/getify/You-Dont-Know-JS/raw/master/this%20%26%20object%20prototypes/fig3.png\" alt=\"img\"></a></p>\n<h3>\"Constructors\"</h3>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">Foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token class-name\">Foo</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span>constructor <span class=\"token operator\">===</span> Foo<span class=\"token punctuation\">;</span> <span class=\"token comment\">// true</span>\n\n<span class=\"token keyword\">var</span> a <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\na<span class=\"token punctuation\">.</span>constructor <span class=\"token operator\">===</span> Foo<span class=\"token punctuation\">;</span> <span class=\"token comment\">// true (shadow)</span></code></pre></div>\n<p>å®é™…ä¸Šé¢çš„ä¸¤ä¸ªåˆ¤æ–­ï¼Œç¬¬ä¸€ä¸ªæ˜¯<code class=\"language-text\">Foo.prototype</code>çš„é»˜è®¤ç‰¹æ€§ï¼Œç¬¬äºŒä¸ªæ˜¯åˆ©ç”¨äº†shadowingã€‚ä¸ºäº†æ›´å¥½çš„ç†è§£ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å¦‚ä¸‹çš„å®ä¾‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">Foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">/* .. */</span> <span class=\"token punctuation\">}</span>\n\n<span class=\"token class-name\">Foo</span><span class=\"token punctuation\">.</span>prototype <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">/* .. */</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// create a new prototype object</span>\n\n<span class=\"token keyword\">var</span> a1 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\na1<span class=\"token punctuation\">.</span>constructor <span class=\"token operator\">===</span> Foo<span class=\"token punctuation\">;</span> <span class=\"token comment\">// false!</span>\na1<span class=\"token punctuation\">.</span>constructor <span class=\"token operator\">===</span> Object<span class=\"token punctuation\">;</span> <span class=\"token comment\">// true!</span></code></pre></div>\n<p>å› ä¸º<code class=\"language-text\">Foo.prototype</code>ä¸å†å’Œ<code class=\"language-text\">Foo</code>æœ‰å…³ç³»äº†ï¼Œæ‰€ä»¥<code class=\"language-text\">a1.constuctor</code>ä¹Ÿè‡ªç„¶ä¸æ˜¯<code class=\"language-text\">Foo</code>äº†ã€‚</p>\n<p>å½“ç„¶ï¼Œè¿˜å¯ä»¥åŠ å›æ¥ï¼Œè™½ç„¶æœ‰ç‚¹éº»çƒ¦ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">Foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">/* .. */</span> <span class=\"token punctuation\">}</span>\n\n<span class=\"token class-name\">Foo</span><span class=\"token punctuation\">.</span>prototype <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">/* .. */</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// create a new prototype object</span>\n\n<span class=\"token comment\">// Need to properly \"fix\" the missing `.constructor`</span>\n<span class=\"token comment\">// property on the new object serving as `Foo.prototype`.</span>\n<span class=\"token comment\">// See Chapter 3 for `defineProperty(..)`.</span>\nObject<span class=\"token punctuation\">.</span><span class=\"token function\">defineProperty</span><span class=\"token punctuation\">(</span> <span class=\"token class-name\">Foo</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">,</span> <span class=\"token string\">\"constructor\"</span> <span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n\tenumerable<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n\twritable<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n\tconfigurable<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n\tvalue<span class=\"token punctuation\">:</span> Foo    <span class=\"token comment\">// point `.constructor` at `Foo`</span>\n<span class=\"token punctuation\">}</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3>Mechanics</h3>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">Foo</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">name</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> name<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token class-name\">Foo</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">myName</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">var</span> a <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Foo</span><span class=\"token punctuation\">(</span> <span class=\"token string\">\"a\"</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> b <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Foo</span><span class=\"token punctuation\">(</span> <span class=\"token string\">\"b\"</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\na<span class=\"token punctuation\">.</span><span class=\"token function\">myName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"a\"</span>\nb<span class=\"token punctuation\">.</span><span class=\"token function\">myName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"b\"</span></code></pre></div>\n<p>è¿™é‡Œå®é™…ä¸Šæ˜¯é€šè¿‡shadowæ¥è¾¾åˆ°ç±»ä¼¼äºclassçš„æ•ˆæœçš„ã€‚</p>\n<h2>\"(Prototypal) Inheritance\"</h2>\n<p>ç”¨ä¸Šè¿°çš„æ–¹å¼ä¹Ÿå¯ä»¥è¿›è¡Œç±»ä¼¼ç»§æ‰¿çš„æœºåˆ¶ï¼Œé¦–å…ˆæ¥çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">Foo</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">name</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> name<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token class-name\">Foo</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">myName</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Bar</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">name<span class=\"token punctuation\">,</span>label</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token function\">Foo</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> name <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>label <span class=\"token operator\">=</span> label<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// here, we make a new `Bar.prototype`</span>\n<span class=\"token comment\">// linked to `Foo.prototype`</span>\n<span class=\"token class-name\">Bar</span><span class=\"token punctuation\">.</span>prototype <span class=\"token operator\">=</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span> <span class=\"token class-name\">Foo</span><span class=\"token punctuation\">.</span>prototype <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Beware! Now `Bar.prototype.constructor` is gone,</span>\n<span class=\"token comment\">// and might need to be manually \"fixed\" if you're</span>\n<span class=\"token comment\">// in the habit of relying on such properties!</span>\n\n<span class=\"token class-name\">Bar</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">myLabel</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>label<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">var</span> a <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Bar</span><span class=\"token punctuation\">(</span> <span class=\"token string\">\"a\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"obj a\"</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\na<span class=\"token punctuation\">.</span><span class=\"token function\">myName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"a\"</span>\na<span class=\"token punctuation\">.</span><span class=\"token function\">myLabel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"obj a\"</span></code></pre></div>\n<p>è¿™é‡Œçš„å…³é”®æ˜¯<code class=\"language-text\">Bar.prototype = Object.create( Foo.prototype )</code>ã€‚</p>\n<p>æ³¨æ„ä¸èƒ½ç”¨<code class=\"language-text\">Bar.prototype = Foo.prototype</code>ï¼Œé‚£æ ·çš„è¯ï¼Œ<code class=\"language-text\">Foo</code>å’Œ<code class=\"language-text\">Bar</code>åˆ›é€ å‡ºæ¥çš„ä¸œè¥¿å°±åŸºæœ¬ä¸€æ ·äº†ï¼ˆé™¤äº†å‡½æ•°é‡Œçš„åˆå§‹åŒ–å†…å®¹ï¼‰ã€‚</p>\n<p>åœ¨æµè§ˆå™¨ä¸­æœ‰ä¸€ç§éæ ‡å‡†çš„<code class=\"language-text\">.__proto__</code>å¯ä»¥ç”¨æ¥è®¾ç½®linkã€‚ES6ä¹Ÿæ·»åŠ äº†ä¸€ç§æ–¹æ³•ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// pre-ES6</span>\n<span class=\"token comment\">// throws away default existing `Bar.prototype`</span>\n<span class=\"token class-name\">Bar</span><span class=\"token punctuation\">.</span>prototype <span class=\"token operator\">=</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span> <span class=\"token class-name\">Foo</span><span class=\"token punctuation\">.</span>prototype <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// ES6+</span>\n<span class=\"token comment\">// modifies existing `Bar.prototype`</span>\nObject<span class=\"token punctuation\">.</span><span class=\"token function\">setPrototypeOf</span><span class=\"token punctuation\">(</span> <span class=\"token class-name\">Bar</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Foo</span><span class=\"token punctuation\">.</span>prototype <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3>Inspecting \"Class\" Relationships</h3>\n<p>å¦‚æœè¦æŸ¥çœ‹ä¸€ä¸ªå˜é‡çš„æ„é€ å‡½æ•°ï¼Œå¯ä»¥ç”¨<code class=\"language-text\">instanceof</code></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> a <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\na <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">Foo</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// true</span>\na <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// true</span></code></pre></div>\n<p>å¦‚æœè¦çœ‹ä¸¤ä¸ªå¯¹è±¡æ˜¯ä¸æ˜¯è¿ç€çš„ï¼Œå¯ä»¥è¿™æ ·ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// helper utility to see if `o1` is</span>\n<span class=\"token comment\">// related to (delegates to) `o2`</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">isRelatedTo</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">o1<span class=\"token punctuation\">,</span> o2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">function</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\t<span class=\"token class-name\">F</span><span class=\"token punctuation\">.</span>prototype <span class=\"token operator\">=</span> o2<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">return</span> o1 <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">F</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">var</span> a <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> b <span class=\"token operator\">=</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span> a <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">isRelatedTo</span><span class=\"token punctuation\">(</span> b<span class=\"token punctuation\">,</span> a <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// true</span></code></pre></div>\n<p>æˆ–è€…æ›´ç®€å•çš„ï¼ŒES5ä¸­æœ‰ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// Simply: does `b` appear anywhere in</span>\n<span class=\"token comment\">// `c`s [[Prototype]] chain?</span>\nb<span class=\"token punctuation\">.</span><span class=\"token function\">isPrototypeOf</span><span class=\"token punctuation\">(</span> c <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ä¹Ÿå¯ä»¥ç›´æ¥è·å–<code class=\"language-text\">[[Prototype]]</code></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">Object<span class=\"token punctuation\">.</span><span class=\"token function\">getPrototypeOf</span><span class=\"token punctuation\">(</span> a <span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token class-name\">Foo</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">;</span> <span class=\"token comment\">// true</span>\nObject<span class=\"token punctuation\">.</span><span class=\"token function\">getPrototypeOf</span><span class=\"token punctuation\">(</span> a <span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">;</span> <span class=\"token comment\">// false</span></code></pre></div>\n<p>å¤§å¤šæ•°æµè§ˆå™¨è¿˜æ”¯æŒï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">a<span class=\"token punctuation\">.</span>__proto__ <span class=\"token operator\">===</span> <span class=\"token class-name\">Foo</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">;</span> <span class=\"token comment\">// true</span></code></pre></div>\n<p>è¿™ä¸ª<code class=\"language-text\">__proto__</code>ä¹Ÿæ˜¯shadowå¯¼è‡´çš„ã€‚</p>\n<h2>Object Links</h2>\n<p>é™¤äº†<code class=\"language-text\">new</code>è¿™ç§ç›¸å½“é—´æ¥çš„æ–¹æ³•ï¼Œè¿˜å¯ä»¥ç”¨<code class=\"language-text\">create</code>æ¥åˆ›å»ºé“¾æ¥ã€‚</p>\n<h4><code class=\"language-text\">Object.create()</code> Polyfilled</h4>\n<p>åˆ°äº†ES5æˆ‘ä»¬æ‰æœ‰<code class=\"language-text\">Object.create(..)</code> ã€‚è¿™é‡Œç»™ä¸€ä¸ªpolyfilled</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>Object<span class=\"token punctuation\">.</span>create<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\tObject<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">create</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">o</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">function</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\t\t<span class=\"token class-name\">F</span><span class=\"token punctuation\">.</span>prototype <span class=\"token operator\">=</span> o<span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">F</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>ES6 <code class=\"language-text\">class</code></h2>\n<p>ES6çš„<code class=\"language-text\">class</code>åªæ˜¯æŠ«ç€ç‹¼çš®çš„ğŸï¼Œåªæ˜¯è¯­æ³•ç³–ã€‚æ‰€ä»¥å®é™…ä¸Šè¿˜æ˜¯<code class=\"language-text\">prototype</code>è¿™ä¸€å¥—ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">C</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>num <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token function\">rand</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\tconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span> <span class=\"token string\">\"Random: \"</span> <span class=\"token operator\">+</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>num <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">var</span> c1 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">C</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nc1<span class=\"token punctuation\">.</span><span class=\"token function\">rand</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"Random: 0.4324299...\"</span>\n\n<span class=\"token class-name\">C</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">rand</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\tconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span> <span class=\"token string\">\"Random: \"</span> <span class=\"token operator\">+</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">round</span><span class=\"token punctuation\">(</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>num <span class=\"token operator\">*</span> <span class=\"token number\">1000</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">var</span> c2 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">C</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nc2<span class=\"token punctuation\">.</span><span class=\"token function\">rand</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"Random: 867\"</span>\n\nc1<span class=\"token punctuation\">.</span><span class=\"token function\">rand</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"Random: 432\" -- oops!!!</span></code></pre></div>\n<blockquote>\n<p>What a sad commentary on JavaScript: <strong>dynamic is too hard, let's pretend to be (but not actually be!) static</strong>.</p>\n</blockquote>","frontmatter":{"title":"Javascript Basics -- prototype","date":"2019-07-23T13:59:53.000Z","tags":["js"]}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/js-basic-prototype/"}}}